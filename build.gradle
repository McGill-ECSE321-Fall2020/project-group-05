task stage() {
    dependsOn ':VisArtApplication:assemble'
}

task integrationTest(type: Exec) {
	dependsOn ':VisArtApplication:bootJar'
	dependsOn ':JavaHttpRequests:jar'
	
    commandLine 'python','--version'
    commandLine 'pip','install','-r','requirements.txt'
    if (System.getProperty('os.name').toLowerCase(Locale.ROOT).contains('windows')) {
        // on windows
        commandLine 'python','VisArtApplication\\integrationTest.py'
        // commandLine 'cmd','/c','VisArtApplication\\integrationTest.bat'
    } else {
        // on linux
        commandLine 'python','VisArtApplication/integrationTest.py'
        // commandLine './VisArtApplication/integrationTest.sh'
    }
}

test {
    environment "JDBC_DATABASE_URL","jdbc:postgresql://ec2-34-200-106-49.compute-1.amazonaws.com:5432/d1fa9t0eht8kmf?password=8aa27235bd628d960a06b94da267acd22842e00556aecad5ac331094b6c0b9a8&sslmode=require&user=ujosysdilonyjy"
    environment "DATABASE_URL","postgres://ujosysdilonyjy:8aa27235bd628d960a06b94da267acd22842e00556aecad5ac331094b6c0b9a8@ec2-34-200-106-49.compute-1.amazonaws.com:5432/d1fa9t0eht8kmf"
    environment "SPRING_DATASOURCE_URL","jdbc:postgresql://ec2-34-200-106-49.compute-1.amazonaws.com:5432/d1fa9t0eht8kmf?password=8aa27235bd628d960a06b94da267acd22842e00556aecad5ac331094b6c0b9a8&sslmode=require&user=ujosysdilonyjy"
    environment "SPRING_DATASOURCE_USERNAME","ujosysdilonyjy"
    environment "SPRING_DATASOURCE_PASSWORD","8aa27235bd628d960a06b94da267acd22842e00556aecad5ac331094b6c0b9a8"
    systemProperty "spring.datasource.url", "jdbc:postgresql://ec2-34-200-106-49.compute-1.amazonaws.com:5432/d1fa9t0eht8kmf?password=8aa27235bd628d960a06b94da267acd22842e00556aecad5ac331094b6c0b9a8&sslmode=require&user=ujosysdilonyjy"
}